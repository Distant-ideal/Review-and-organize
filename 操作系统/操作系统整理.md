# 操作系统整理

## 操作系统的特征

### 并发

#### 并发

两个或多个事件在同一时间间隔内发生，这些事件宏观上是同时发生的，但微观上是交替发生的

（某一个时刻最多进行一个任务）

一个单核处理机同一时刻只能执行一个程序，因此操作系统会负责协调多个程序交替执行

4核CPU意味着同时可以有4个程序并行执行

#### 并行

指两个或者多个事件在同一时刻同时发生

### 共享  

共享即资源共享，是指系统中的资源可供内存多个并发执行的进程共同使用

#### 互斥共享方式

虽然可以提供给多个进程使用，但一个事件段内只允许一个进程访问该资源（例如qq和微信视频只能有一个可以使用摄像头）

#### 同时共享方式

允许一个时间段内由多个进程同时对它们进行访问（宏观上是同时发生的，但微观上是交替发生的）（qq和微信可以同时发送文件）

并发和共享的关系

并发性是指计算机系统中同时存在多个运行这的程序（qq和微信同时发送文件）

共享性是指系统中的资源可以供内存中多个个性发执行的进行共同使用（qq和微信同时访问磁盘资源）

### 虚拟

虚拟是指一个物理上的实体变为若干个逻辑上的对应物。物理实体是实际存在的而逻辑上对应物是用户感受到的

虚拟技术中的时分复用技术：微观上处理机在各个微笑的时间段内交替着为各个进程服务

如果失去了并发性一个时间段系统只需运行一道城西，那么就失去了实现虚拟性的意义了，因此没有并发性就谈不上虚拟性。

#### 空分复用技术

如虚拟存储器技术

#### 时分复用技术

如虚拟处理器

### 异步

在多道程序环境下，允许多个程序并发执行，但由于资源有限，进程的执行不是一贯到底的，而是走走停停的，以不可预知的舒服向前推进，这就是进程的异步性。

如果失去了并发性，则系统只能串行地处理各个进程，每个进程的执行会一贯到底。只有系统拥有并发向，在有可能导致异步性。

### 指令

语言代码会被翻译成机器语言指令

指令就是CPU能识别执行的最基本命令

#### 特权指令

如内存清零指令（不允许用户程序使用）

#### 费特权指令

如普通运算指令

#### CPU如何判断档期那是否可以执行特权指令

##### 两种处理器状态

用程序状态字寄存器（PSW）中的某标志位来标识档期那处理器处于什么状态

用户态（目态） 此时CPU只能执行非特权指令

核心态（管态）特权指令非特权指令都可以执行

##### 两种程序

内核程序

操作系统的内核程序是系统的管理者，既可以执行特权指令，也可以执行非特权指令，运行在核心态。

应用程序

为了保证系统能安全运行，普通应用程序只能执行非特权指令，运行在用户态

### 中断和异常

#### 中断

本质：发生了中断就意味着需要操作系统的介入展开管理工作

1.当中断发生时，CPU立即进入核心态

2.当中断发生时，当前运行的进程暂停运行，并由操作系统内核对中断进行处理

3.对于不同的中断信号，会进行不同的处理

发生中断，就意味着需要操作系统介入，展开管理工作。由于操作系统的管理工作需要使用特权指令，因此CPU要从用户态转为核心态，中断可以使CPU从用户态切换为核心态，使操作胸膛获得计算机的控制权。有了中断，才能实现多道程序并发执行。

中断唯一一个使CPU从用户态进入核心态的途径

## 进程

程序是一个指令序列

1.进程是程序的一次执行过程

2.进程是一个程序及其数据在处理机上顺序执行时发生的活动

3.进程是具有独立功能的程序在数据集合上运行的过程，他是系统进行资源分配和调度的一个独立单位

（强调“动态性”）

### 进程的特征

动态性：进程是程序的一次执行过程是动态地常胜变化和消亡的

并发性：内存中有多个进程实体，个进程可并发执行

独立性：进程是能够地理运行，独立获得资源，独立接受调度的基本单位

异步性：个进程按各自独立的，不可预测的速度向前推进，操作提供要提供进程同步机制来解决异步问题

结构性：每个进程都会配置一个PCB，结构上看，进程由程序段，数据段，PCB组成

### 进程的三种

运行态：占有CPU并在CPU上运行

就绪态：已经具备运行条件但是由于没有空闲CPU暂时不能运行

阻塞态：因等待某一事件而暂时不能运行

### 进程控制

进程控制主要功能是对系统的所有进程实施有效的管理，它具有创建新进程，撤销已有进程，实现进程状态转换等功能

### 进程通信

共享内存：基于数据结构的共享，基于存储区的共享

消息传递：直接通信方式，间接通信方式

管道通信

### 生产者消费者问题

系统中有一组生产者进程和一组消费者进程，生产者进程每次生产一个产品放入缓冲区，消费者进程每次从缓冲区取出一个产品并使用

## 死锁

系统中资源出现相互等待的状态

互斥条件

请求和保持条件

不可剥夺条件

环路等待条件

## 内存

内存是用于存放数据的硬件。程序执行之前要先放到内存中才能被CPU处理

内存的地址：每一个地址对应一个存储单元

相对地址又称为逻辑地址，绝对地址又称为物理地址

### 内存管理

1.操作系统负责内存空间的分配与回收

2.操作系统需要提供某种技术从逻辑上对内存空间进行扩充

3.操作系统需要提供地址转换的功能，负责程序的逻辑地址与物理地址的转换

### 基本的分页存储管理

## 堆和栈的区别

1.申请方式的不同。栈由系统自动分配，而堆是人为申请开辟;

2.申请大小的不同。栈获得的空间较小，而堆获得的空间较大;

3.申请效率的不同。栈由系统自动分配，速度较快，而堆一般速度比较慢;

4.存储内容的不同。栈在函数调用时，函数调用语句的下一条可执行语句的地址第一个进栈，然后函数的各个参数进栈，其中静态变量是不入栈的。而堆一般是在头部用一个字节存放堆的大小，堆中的具体内容是人为安排;

5.底层不同。栈是连续的空间，而堆是不连续的空间。







## 代码的执行过程

![运行过程](D:\春招复习\图片\运行过程.png)

•预处理阶段：预处理器（cpp）根据‘#’包含的头文件，将头文件的内容加进源程序中。得到新的程序文件文本，以“.i”为文件扩展名。比如说helloworld程序包含stdio.h头文件， 这个阶段将这个头文件的内容插进源程序中
•编译阶段：编译器（ccl）将文本文件hello.i翻译成汇编程序hello.S。也就是将高级语言翻译成汇编代码，低级的机器语言指令。
•汇编阶段：汇编器（as）将汇编程序hello.S翻译成机器指令，将这些指令打包成可重定位目标程序的格式，并把结果保存在hello.o文件中，hello.o是个二进制文件。
•链接阶段：链接器（ld）将会把一个工程中所有的.o文件链接合并成一个可执行目标文件，可以被加载在内存中，由系统运行。 

以上就是c，c++程序编译过程

